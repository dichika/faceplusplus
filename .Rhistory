options()$FACEPP_KEY
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?url=http://faceplusplus.com/static/img/demo/1.jpg&api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
options()$FACEPP_SECRET,
options()$FACEPP_KEY
)
res <- GET(u)
library("httr")
res <- GET(u)
res <- content(res)
res
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?img=/Users/ichikawadaisuke/Downloads/scroll0014.jpg&api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
options()$FACEPP_SECRET,
options()$FACEPP_KEY
)
res <- POST(u)
res <- content(res)
res
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?url=http://faceplusplus.com/static/img/demo/1.jpg&api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
options()$FACEPP_SECRET,
options()$FACEPP_KEY
)
res <- POST(u)
res <- content(res)
res
?POST
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
options()$FACEPP_SECRET,
options()$FACEPP_KEY
)
f <- "/Users/ichikawadaisuke/Downloads/scroll0014.jpg"
res <- POST(u,
body=list(img=upload_file(f)))
res <- content(res)
res
str(res)
library("jsonlite")
res <- POST(u,
body=list(img=upload_file(f)))
fromJSON(res)
res
str(res)
?URLencode
URLencode
f <- "http://faceplusplus.com/static/img/demo/1.jpg"
grepl("^http|^https", f)
f <- "/Users/ichikawadaisuke/Downloads/scroll0014.jpg"
grepl("^http|^https", f)
f <- "https://faceplusplus.com/static/img/demo/1.jpg"
grepl("^http|^https", f)
getDetect <- function(file, secret=options()$FACEPP_SECRET, key=options()$FACEPP_KEY){
if(grepl("^http|^https", file)){
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?url=%s&api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
file,secret,key
)
res <- GET(u)
} else{
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
secret, key
)
res <- POST(u, body=list(img=upload_file(file)))
}
res <- content(res)
}
f <- "http://faceplusplus.com/static/img/demo/1.jpg"
smp <- getDetect(f)
smp
smp$face[[1]]$attribute$age$value
smp$face[[2]]$attribute$age$value
getDetect <- function(file, secret=options()$FACEPP_SECRET, key=options()$FACEPP_KEY){
if(grepl("^http|^https", file)){
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?url=%s&api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
file,secret,key
)
res <- GET(u)
} else{
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
secret, key
)
res <- POST(u, body=list(img=upload_file(file)))
}
res <- content(res, as="text")
res <- jsonlite::fromJSON(res)
}
smp <- getDetect(f)
smp
f <- "/Users/ichikawadaisuke/Downloads/Verification 1-1.jpg"
smp <- getDetect(f)
smp
getDetect <- function(file, secret=options()$FACEPP_SECRET, key=options()$FACEPP_KEY){
getDetect <- function(file, secret=options()$FACEPP_SECRET, key=options()$FACEPP_KEY){
if(grepl("^http|^https", file)){
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?url=%s&api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
file,secret,key
)
res <- GET(u)
} else{
u <- sprintf("https://apius.faceplusplus.com/v2/detection/detect?api_secret=%s&api_key=%s&attribute=glass,pose,gender,age,race,smiling",
secret, key
)
res <- POST(u, body=list(img=upload_file(file)))
}
res <- content(res, as="text")
res <- jsonlite::fromJSON(res)
return(res$face)
}
smp <- getDetect(f)
smp
f <- "/Users/ichikawadaisuke/Pictures/iPhoto Library.photolibrary/Masters/2015/05/01/20150501-145808/写真（2015-05-01 14.57）.jpg"
smp <- getDetect(f)
smp
f <- "/Users/ichikawadaisuke/Pictures/iPhoto Library.photolibrary/Masters/2015/05/01/20150501-150054/写真（2015-05-01 15.00）.jpg"
smp <- getDetect(f)
smp
file.choose()
file.choose("~/Pictures/iPhoto Library.photolibrary/Masters/")
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
f <- choose.file()
setwd(old)
res <- getDetect(f)
}
photo2AgefromMac()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
f <- file.choose()
setwd(old)
res <- getDetect(f)
}
photo2AgefromMac()
library(faceplusplus)
smp <- photo2AgefromMac()
smp
library(faceplusplus)
devtools::install_github("dichika/faceplusplus")
library("faceplusplus")
smp <- photo2AgefromMac()
smp
old <- setwd("~/faceplusplus")
old
setwd("~/faceplusplus")
getwd()
smp <- photo2AgefromMac()
photo2AgefromMac
?file.choose
?setwd
?choose.files
file.choose(TRUE)
library(faceplusplus)
file.choose(TRUE)
getwd()
setwd("~_faceplusplus")
setwd("~/faceplusplus")
file.choose(TRUE)
smp = photo2AgefromMac()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
Sys.sleep(1)
f <- file.choose()
setwd(old)
res <- getDetect(f)
}
smp = photo2AgefromMac()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
Sys.sleep(0.5)
f <- file.choose()
setwd(old)
res <- getDetect(f)
}
smp = photo2AgefromMac()
getwd()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
Sys.sleep(0.5)
f <- try(file.choose(),setwd(old))
setwd(old)
res <- getDetect(f)
}
setwd("~/faceplusplus")
smp = photo2AgefromMac()
getwd)()
getwd()
args(try)
args(tryCatch)
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
Sys.sleep(0.5)
f <- tryCatch(file.choose(),finally=setwd(old))
setwd(old)
res <- getDetect(f)
}
getwd()
smp = photo2AgefromMac()
getwd()
smp = photo2AgefromMac()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
Sys.sleep(1)
f <- tryCatch(file.choose(),finally=setwd(old))
setwd(old)
res <- getDetect(f)
}
smp = photo2AgefromMac()
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
old
setwd(old)
smp = photo2AgefromMac()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
print(getwd())
Sys.sleep(10)
f <- tryCatch(file.choose(),finally=setwd(old))
setwd(old)
res <- getDetect(f)
}
smp = photo2AgefromMac()
getwd()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
print(getwd())
Sys.sleep(10)
f <- tryCatch(file.choose(),finally=print(getwd()))
setwd(old)
res <- getDetect(f)
}
smp = photo2AgefromMac()
file.choose()
setwd("~/faceplusplus")
file.choose()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
print(getwd())
Sys.sleep(1)
f <- tryCatch(file.choose(),finally=print(getwd()))
setwd(old)
res <- getDetect(f)
}
smp = photo2AgefromMac()
file.choose()
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
f <- file.choose()
setwd(old)
res <- getDetect(f)
}
setwd("~/faceplusplus")
photo2AgefromMac <- function(){
old <- setwd("~/Pictures/iPhoto Library.photolibrary/Masters/")
f <- file.choose()
setwd(old)
res <- getDetect(f)
}
photo2AgefromMac()
getwd()
setwd("~/faceplusplus")
fs <- list.files("~/Pictures/iPhoto Library.photolibrary/Masters/")
fs
dir="~/photos"
fs <- list.files(dir)
fs
fs <- list.files(dir)
fs
file.info(fs)
fs <- list.files(dir,full.names=TRUE)
file.info(fs)
which.max(file.info(fs)$mtime)
library(faceplusplus)
smp <- photo2AgefromMac()
photo2AgefromMac
library(faceplusplus)
photo2AgefromMac
devtools::install_github("dichika/faceplusplus")
photo2AgefromMac
library("faceplusplus")
photo2AgefromMac
library("faceplusplus")
library(faceplusplus)
photo2AgefromMac
smp <- photo2AgefromMac()
smp
detach("package:faceplusplus", unload=TRUE)
library(faceplusplus)
getDetect("http://www.lespros.co.jp/files/talent/4/profile.jpg")
library(faceplusplus)
getDetect("~/photos/写真（2015-05-01 15.00）.jpg")
library(faceplusplus)
